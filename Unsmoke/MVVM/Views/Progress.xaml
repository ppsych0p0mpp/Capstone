<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="Unsmoke.MVVM.Views.Progress"
             xmlns:vm="clr-namespace:Unsmoke.MVVM.ViewModel"
             Title="Progress"
             x:Name="ItemsPage">

    <ContentPage.BindingContext>
        <vm:ProgressVM/>
    </ContentPage.BindingContext>
    

    <ScrollView>
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <Grid HeightRequest="40">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width=".33*"/>
                    <ColumnDefinition Width=".33*"/>
                    <ColumnDefinition Width=".33*"/>
                </Grid.ColumnDefinitions>
                <Border Grid.Column="0" Background="Black" HeightRequest="50" Stroke="Black" StrokeThickness="2">
                    <Label Text="Burger" Grid.Column="0"/>
                </Border>
                <Label Text="Unsmoke" Grid.Column="1" HorizontalOptions="Center" VerticalTextAlignment="Center" TextColor="Black"/>

                <Label Text="Profile" Grid.Column="2" HorizontalOptions="End" VerticalTextAlignment="Center" TextColor="Black"/>
            </Grid>

            <!--Item Comparison-->
            <Label Text="Item Comparison"
                   Margin="20,40,0,0"
                   Grid.Row="1"
                   FontSize="15"/>

            <Border HeightRequest="250" BackgroundColor="#2E2E2E" WidthRequest="370"
                    Grid.Row="1"
                    Margin="40,70,40,0"
                    StrokeShape="RoundRectangle 20"
                    IsVisible="{Binding Itemcomp}">
                <VerticalStackLayout>
                    <Label Text="You could have bought a.."
                           TextColor="White"
                           Margin="20"
                           HorizontalOptions="Center"
                           FontAttributes="Bold"/>
                    <!-- Clickable Image -->
                    <Frame WidthRequest="100"
                           HeightRequest="100"
                           CornerRadius="10"
                           Margin="32,0,0,0"
                           Padding="0"
                           HasShadow="False"
                           BorderColor="LightGray"
                           BackgroundColor="White"
                           HorizontalOptions="Start"
                           VerticalOptions="Start">
                        <Image Source="{Binding Image}" 
                                   Aspect="AspectFit"
                                   WidthRequest="100"
                                   HeightRequest="150">
                            <Image.GestureRecognizers>
                                <TapGestureRecognizer Command="{Binding Source={x:Reference ItemsPage}, Path=BindingContext.PickImageCommand}" />
                            </Image.GestureRecognizers>
                        </Image>
                    </Frame>
                    <Button Text="Confirm"
                            TextColor="Black"
                            HeightRequest="40"
                            WidthRequest="100"
                            VerticalOptions="End"
                            Margin="-200,20,0,0"
                            BackgroundColor="#FFC000"
                            Command="{Binding AddItemCommand}"/>
                    
                    <Border Stroke="White"
                            Margin="180,-160,0,0"
                            HeightRequest="50"
                            WidthRequest="150"
                            >

                        <Entry Placeholder="NAME"
                               PlaceholderColor="White"
                               TextColor="Black"
                               FontSize="16"
                               HorizontalTextAlignment="Center"
                               HeightRequest="90"
                               BackgroundColor="DarkGray"
                               Text="{Binding ItemName, Mode=TwoWay}"/>

                    </Border>

                    <Border Stroke="White"
                            HeightRequest="50"
                            WidthRequest="150"
                            Margin="180,20,0,0">
                            <Entry Placeholder="PRICE"
                                   PlaceholderColor="White"
                                   TextColor="Black"
                                   FontSize="16"
                                   HorizontalTextAlignment="Center"
                                   HeightRequest="90"
                                   BackgroundColor="DarkGray"
                                   Keyboard="Numeric"
                                   Text="{Binding ItemPrice, Mode=TwoWay}"/>
                    </Border>

                    <Label Margin="180,20,0,0"
                           Text="Click to show Progress"
                           TextColor="White"
                           HorizontalOptions="Center">
                        <Label.GestureRecognizers>
                            <TapGestureRecognizer Command="{Binding ShowProgress}"/>
                        </Label.GestureRecognizers>
                    </Label>



                </VerticalStackLayout>
                
               
            </Border>

            <!--Click Show Savings-->
            <Border StrokeThickness="0"
                    BackgroundColor="#2E2E2E"
                    Padding="15"
                    Margin="40,70,40,0"
                    Grid.Row="1"
                    HeightRequest="250"
                    WidthRequest="370"
                    IsVisible="{Binding Showprog}">
                <Border.StrokeShape>
                    <RoundRectangle CornerRadius="20"/>
                </Border.StrokeShape>

                    <VerticalStackLayout Spacing="15">
                    <!-- Total Saved Header -->
                    <HorizontalStackLayout Spacing="10" VerticalOptions="Center">
                        <Image Source="peso" HeightRequest="50" WidthRequest="50"/>
                        <VerticalStackLayout>
                            <Label Text="₱750"
                                   FontSize="24"
                                   FontAttributes="Bold"
                                   TextColor="White"/>
                            <Label Text="Total Saved"
                                   FontSize="12"
                                   TextColor="#BDBDBD"/>
                            <ImageButton Source="close"
                                         HorizontalOptions="End"
                                         WidthRequest="20"
                                         HeightRequest="50"
                                         Margin="250,-60,0,0"
                                         Command="{Binding ItemComp}"/>
                        </VerticalStackLayout>
                    </HorizontalStackLayout>

                    <!-- Daily Goal -->
                    <HorizontalStackLayout Spacing="5" VerticalOptions="Center">
                        <Label Text="Daily savings goal" FontSize="12" TextColor="White" HorizontalOptions="StartAndExpand"/>
                        <Label Text="₱50/₱50" FontSize="12" TextColor="White" HorizontalOptions="End"/>
                    </HorizontalStackLayout>
                    <ProgressBar Progress="1" HeightRequest="6" ProgressColor="#FFD700" BackgroundColor="#555"/>

                    <!-- Weekly Goal -->
                    <HorizontalStackLayout Spacing="5" VerticalOptions="Center">
                        <Label Text="Weekly savings goal" FontSize="12" TextColor="White" HorizontalOptions="StartAndExpand"/>
                        <Label Text="₱350/₱350" FontSize="12" TextColor="White" HorizontalOptions="End"/>
                    </HorizontalStackLayout>
                    <ProgressBar Progress="1" HeightRequest="6" ProgressColor="#4CAF50" BackgroundColor="#555"/>

                    <!-- Monthly Goal -->
                    <HorizontalStackLayout Spacing="5" VerticalOptions="Center">
                        <Label Text="Monthly savings goal" FontSize="12" TextColor="White" HorizontalOptions="StartAndExpand"/>
                        <Label Text="₱750/₱1,500" FontSize="12" TextColor="White" HorizontalOptions="End"/>
                    </HorizontalStackLayout>
                    <ProgressBar Progress="0.5" HeightRequest="6" ProgressColor="#2196F3" BackgroundColor="#555"/>
                </VerticalStackLayout>
            </Border>


            <!--Milestone -->
            <Label Text="Achievement Board"
                   Grid.Row="3" Margin="20,20,0,0"
                   TextColor="Black"
                   FontSize="15"
                   />
            
            <CollectionView Grid.Row="3"
                            ItemsSource="{Binding Achievements}"
                            VerticalOptions="Start"
                            Margin="10,50,0,0"
                            >
                <CollectionView.ItemsLayout>
                    <!-- 2 Columns -->
                    <GridItemsLayout Orientation="Vertical" Span="2"/> 
                </CollectionView.ItemsLayout>
  
                <CollectionView.ItemTemplate>
                    <DataTemplate>
                        <Border StrokeThickness="1"
                                Stroke="#ffc000"
                                Margin="5"
                                Padding="10"
                                HeightRequest="100"
                                Background="{Binding IsUnlocked, Converter={StaticResource BoolToColorConverter}}">
                            <Border.StrokeShape>
                                <RoundRectangle CornerRadius="20"/>
                            </Border.StrokeShape>
                            <VerticalStackLayout HorizontalOptions="Center" VerticalOptions="Center" Spacing="5">
                                <Image Source="{Binding Icon}"/>
                                <Label Text="{Binding Title}" 
                                       FontAttributes="Bold" 
                                       FontSize="16"
                                       TextColor="{Binding IsUnlocked, Converter={StaticResource BoolToTextColorConverter}}"
                                       HorizontalOptions="Center"/>
                                <Label Text="{Binding Description}" 
                                       FontSize="12"
                                       TextColor="{Binding IsUnlocked, Converter={StaticResource BoolToTextColorConverter}}"
                                       HorizontalOptions="Center"/>
                            </VerticalStackLayout>
                        </Border>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>
            
        </Grid>
    </ScrollView>
</ContentPage>